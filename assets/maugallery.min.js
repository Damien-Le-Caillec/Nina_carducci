class MauGallery{constructor(t,e={}){this.gallery=t,this.options=Object.assign(MauGallery.defaults,e),this.tagsCollection=[],this.init()}static defaults={columns:3,lightBox:!0,lightboxId:"galleryLightbox",showTags:!0,tagsPosition:"bottom",navigation:!0};init(){this.createRowWrapper(),this.gallery.style.display="block",this.options.lightBox&&this.createLightBox(),this.setupListeners();let t=this.gallery.querySelectorAll(".gallery-item");t.forEach(t=>{this.responsiveImageItem(t),this.wrapItemInColumn(t,this.options.columns),this.moveItemInRowWrapper(t);let e=t.dataset.galleryTag;this.options.showTags&&e&&!this.tagsCollection.includes(e)&&this.tagsCollection.push(e)}),this.options.showTags&&this.showItemTags(),this.options.lightBox&&this.createLightBox(),this.setupListeners(),this.gallery.style.opacity=0,setTimeout(()=>{this.gallery.style.transition="opacity 0.5s",this.gallery.style.opacity=1},10)}createRowWrapper(){if(!this.gallery.firstElementChild?.classList.contains("row")){let t=document.createElement("div");t.className="gallery-items-row row",this.gallery.appendChild(t)}}wrapItemInColumn(t,e){let s=document.createElement("div");s.classList.add("item-column","mb-4"),"number"==typeof e?s.classList.add(`col-${Math.ceil(12/e)}`):"object"==typeof e&&(e.xs&&s.classList.add(`col-${Math.ceil(12/e.xs)}`),e.sm&&s.classList.add(`col-sm-${Math.ceil(12/e.sm)}`),e.md&&s.classList.add(`col-md-${Math.ceil(12/e.md)}`),e.lg&&s.classList.add(`col-lg-${Math.ceil(12/e.lg)}`),e.xl&&s.classList.add(`col-xl-${Math.ceil(12/e.xl)}`)),t.parentNode.insertBefore(s,t),s.appendChild(t)}moveItemInRowWrapper(t){let e=this.gallery.querySelector(".gallery-items-row");e.appendChild(t.closest(".item-column")||t)}responsiveImageItem(t){"IMG"===t.tagName&&t.classList.add("img-fluid")}createLightBox(){let t=document.createElement("div");t.className="modal fade",t.id=this.options.lightboxId,t.setAttribute("tabindex","-1"),t.setAttribute("role","dialog"),t.innerHTML=`
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-body">
            ${this.options.navigation?'<div class="mg-prev" style="cursor:pointer;position:absolute;top:50%;left:-15px;background:white;"><</div>':""}
            <img class="lightboxImage img-fluid" alt="Contenu de l'image affich\xe9e dans la modale au clic"/>
            ${this.options.navigation?'<div class="mg-next" style="cursor:pointer;position:absolute;top:50%;right:-15px;background:white;">></div>':""}
          </div>
        </div>
      </div>
    `,document.body.appendChild(t)}setupListeners(){document.querySelectorAll(".gallery-item").forEach(t=>{t.addEventListener("click",()=>{this.options.lightBox&&"IMG"===t.tagName&&this.openLightBox(t)})}),document.querySelectorAll(".gallery .nav-link").forEach(t=>{t.addEventListener("click",this.filterByTag.bind(this))}),document.querySelector(".gallery").addEventListener("click",t=>{t.target.classList.contains("mg-prev")&&this.prevImage(),t.target.classList.contains("mg-next")&&this.nextImage()}),document.addEventListener("click",t=>{let e=document.getElementById(this.options.lightboxId);e&&t.target===e&&(e.classList.remove("show"),e.style.display="none")}),document.addEventListener("click",t=>{t.target.classList.contains("mg-prev")&&this.prevImage(),t.target.classList.contains("mg-next")&&this.nextImage()})}openLightBox(t){let e=document.getElementById(this.options.lightboxId),s=e.querySelector(".lightboxImage");s.setAttribute("src",t.getAttribute("src")),e.classList.add("show"),e.style.display="block",e.setAttribute("aria-hidden","false"),e.focus()}getFilteredImages(){let t=document.querySelector(".tags-bar .active-tag")?.dataset.imagesToggle||"all",e=Array.from(document.querySelectorAll(".item-column img"));return"all"===t?e:e.filter(e=>e.dataset.galleryTag===t)}prevImage(){let t=document.querySelector(".lightboxImage"),e=t.getAttribute("src"),s=this.getFilteredImages(),i=s.findIndex(t=>t.getAttribute("src")===e),l=(i-1+s.length)%s.length;t.setAttribute("src",s[l].getAttribute("src"))}nextImage(){let t=document.querySelector(".lightboxImage"),e=t.getAttribute("src"),s=this.getFilteredImages(),i=s.findIndex(t=>t.getAttribute("src")===e),l=(i+1)%s.length;t.setAttribute("src",s[l].getAttribute("src"))}showItemTags(){let t=document.createElement("ul");t.className="my-4 tags-bar nav nav-pills",t.innerHTML=`
      <li class="nav-item">
        <span class="nav-link active active-tag" data-images-toggle="all">Tous</span>
      </li>
    `,this.tagsCollection.forEach(e=>{t.innerHTML+=`
        <li class="nav-item">
          <span class="nav-link" data-images-toggle="${e}">${e}</span>
        </li>
      `}),"bottom"===this.options.tagsPosition?this.gallery.appendChild(t):"top"===this.options.tagsPosition?this.gallery.insertBefore(t,this.gallery.firstChild):console.error(`Unknown tags position: ${this.options.tagsPosition}`)}filterByTag(t){let e=t.target;if(e.classList.contains("active-tag"))return;document.querySelectorAll(".active-tag").forEach(t=>t.classList.remove("active","active-tag")),e.classList.add("active-tag");let s=e.dataset.imagesToggle;document.querySelectorAll(".gallery-item").forEach(t=>{let e=t.closest(".item-column");e.style.display="none",("all"===s||t.dataset.galleryTag===s)&&(e.style.display="block",e.style.transition="opacity 0.3s",e.style.opacity=1)})}}